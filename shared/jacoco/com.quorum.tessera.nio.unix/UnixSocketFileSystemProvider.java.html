<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>UnixSocketFileSystemProvider.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">shared</a> &gt; <a href="index.source.html" class="el_package">com.quorum.tessera.nio.unix</a> &gt; <span class="el_source">UnixSocketFileSystemProvider.java</span></div><h1>UnixSocketFileSystemProvider.java</h1><pre class="source lang-java linenums">package com.quorum.tessera.nio.unix;

import java.io.IOException;
import java.io.InputStream;
import java.io.OutputStream;
import java.net.URI;
import java.nio.channels.AsynchronousFileChannel;
import java.nio.channels.FileChannel;
import java.nio.channels.SeekableByteChannel;
import java.nio.file.AccessMode;
import java.nio.file.CopyOption;
import java.nio.file.DirectoryStream;
import java.nio.file.FileStore;
import java.nio.file.FileSystem;
import java.nio.file.FileSystems;
import java.nio.file.LinkOption;
import java.nio.file.OpenOption;
import java.nio.file.Path;
import java.nio.file.attribute.BasicFileAttributes;
import java.nio.file.attribute.FileAttribute;
import java.nio.file.attribute.FileAttributeView;
import java.nio.file.spi.FileSystemProvider;
import java.util.Map;
import java.util.Set;
import java.util.concurrent.ExecutorService;

/**
 * Implementation of FileSystemProvider that handles URIs with unix scheme
 *
 */
public class UnixSocketFileSystemProvider extends FileSystemProvider {

    private final FileSystemProvider delegate;

    public UnixSocketFileSystemProvider() {
<span class="fc" id="L36">        this(FileSystems.getDefault().provider());</span>
<span class="fc" id="L37">    }</span>

<span class="fc" id="L39">    public UnixSocketFileSystemProvider(FileSystemProvider delegate) {</span>
<span class="fc" id="L40">        this.delegate = delegate;</span>
<span class="fc" id="L41">    }</span>

    @Override
    public String getScheme() {
<span class="fc" id="L45">        return &quot;unix&quot;;</span>
    }

    private static URI convert(URI uri) {
<span class="fc" id="L49">        return UriCallback.execute(() -&gt; {</span>
<span class="fc" id="L50">            return new URI(&quot;file&quot;,uri.getUserInfo(),uri.getHost(),uri.getPort(),uri.getPath(),uri.getQuery(),uri.getFragment());</span>
        });

    }

    @Override
    public FileSystem newFileSystem(URI uri, Map&lt;String, ?&gt; env) throws IOException {
<span class="fc" id="L57">        return delegate.newFileSystem(convert(uri), env);</span>
    }

    @Override
    public FileSystem getFileSystem(URI uri) {
<span class="fc" id="L62">        URI adjusted = convert(uri);</span>
<span class="fc" id="L63">        return delegate.getFileSystem(adjusted);</span>
    }

    @Override
    public Path getPath(URI uri) {
<span class="fc" id="L68">        return delegate.getPath(convert(uri));</span>
    }

    @Override
    public SeekableByteChannel newByteChannel(Path path, Set&lt;? extends OpenOption&gt; options, FileAttribute&lt;?&gt;... attrs) throws IOException {
<span class="fc" id="L73">        return delegate.newByteChannel(path, options, attrs);</span>
    }

    @Override
    public DirectoryStream&lt;Path&gt; newDirectoryStream(Path dir, DirectoryStream.Filter&lt;? super Path&gt; filter) throws IOException {
<span class="fc" id="L78">        return delegate.newDirectoryStream(dir, filter);</span>
    }

    @Override
    public void createDirectory(Path dir, FileAttribute&lt;?&gt;... attrs) throws IOException {
<span class="fc" id="L83">        delegate.createDirectory(dir, attrs);</span>
<span class="fc" id="L84">    }</span>

    @Override
    public void delete(Path path) throws IOException {
<span class="fc" id="L88">        delegate.delete(path);</span>
<span class="fc" id="L89">    }</span>

    @Override
    public void copy(Path source, Path target, CopyOption... options) throws IOException {
<span class="fc" id="L93">        delegate.copy(source, target, options);</span>
<span class="fc" id="L94">    }</span>

    @Override
    public FileSystem newFileSystem(Path path, Map&lt;String, ?&gt; env) throws IOException {
<span class="fc" id="L98">        return delegate.newFileSystem(path, env);</span>
    }

    @Override
    public InputStream newInputStream(Path path, OpenOption... options) throws IOException {
<span class="fc" id="L103">        return delegate.newInputStream(path, options);</span>
    }

    @Override
    public OutputStream newOutputStream(Path path, OpenOption... options) throws IOException {
<span class="fc" id="L108">        return delegate.newOutputStream(path, options);</span>
    }

    @Override
    public FileChannel newFileChannel(Path path, Set&lt;? extends OpenOption&gt; options, FileAttribute&lt;?&gt;... attrs) throws IOException {
<span class="fc" id="L113">        return delegate.newFileChannel(path, options, attrs);</span>
    }

    @Override
    public AsynchronousFileChannel newAsynchronousFileChannel(Path path, Set&lt;? extends OpenOption&gt; options, ExecutorService executor, FileAttribute&lt;?&gt;... attrs) throws IOException {
<span class="fc" id="L118">        return delegate.newAsynchronousFileChannel(path, options, executor, attrs);</span>
    }

    @Override
    public void createSymbolicLink(Path link, Path target, FileAttribute&lt;?&gt;... attrs) throws IOException {
<span class="fc" id="L123">        delegate.createSymbolicLink(link, target, attrs);</span>
<span class="fc" id="L124">    }</span>

    @Override
    public void createLink(Path link, Path existing) throws IOException {
<span class="fc" id="L128">        delegate.createLink(link, existing);</span>
<span class="fc" id="L129">    }</span>

    @Override
    public boolean deleteIfExists(Path path) throws IOException {
<span class="fc" id="L133">        return delegate.deleteIfExists(path);</span>
    }

    @Override
    public Path readSymbolicLink(Path link) throws IOException {
<span class="fc" id="L138">        return delegate.readSymbolicLink(link);</span>
    }

    @Override
    public void move(Path source, Path target, CopyOption... options) throws IOException {
<span class="fc" id="L143">        delegate.move(source, target, options);</span>
<span class="fc" id="L144">    }</span>

    @Override
    public boolean isSameFile(Path path, Path path2) throws IOException {
<span class="fc" id="L148">        return delegate.isSameFile(path, path2);</span>
    }

    @Override
    public boolean isHidden(Path path) throws IOException {
<span class="fc" id="L153">        return delegate.isHidden(path);</span>
    }

    @Override
    public FileStore getFileStore(Path path) throws IOException {
<span class="fc" id="L158">        return delegate.getFileStore(path);</span>
    }

    @Override
    public void checkAccess(Path path, AccessMode... modes) throws IOException {
<span class="fc" id="L163">        delegate.checkAccess(path, modes);</span>
<span class="fc" id="L164">    }</span>

    @Override
    public &lt;V extends FileAttributeView&gt; V getFileAttributeView(Path path, Class&lt;V&gt; type, LinkOption... options) {
<span class="fc" id="L168">        return delegate.getFileAttributeView(path, type, options);</span>
    }

    @Override
    public &lt;A extends BasicFileAttributes&gt; A readAttributes(Path path, Class&lt;A&gt; type, LinkOption... options) throws IOException {
<span class="fc" id="L173">        return delegate.readAttributes(path, type, options);</span>
    }

    @Override
    public Map&lt;String, Object&gt; readAttributes(Path path, String attributes, LinkOption... options) throws IOException {
<span class="fc" id="L178">        return delegate.readAttributes(path, attributes, options);</span>
    }

    @Override
    public void setAttribute(Path path, String attribute, Object value, LinkOption... options) throws IOException {
<span class="fc" id="L183">        delegate.setAttribute(path, attribute, value, options);</span>
<span class="fc" id="L184">    }</span>

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.2.201808211720</span></div></body></html>